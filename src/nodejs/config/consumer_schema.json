{
    "$id": "consumer_schema.json",
    "$async": true,
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Telemetry services consumer schema",
    "description": "",
    "type": "object",
    "allOf": [
        {
            "if": { "properties": { "class": { "const": "Telemetry_Consumer" } } },
            "then": {
                "required": [
                    "class",
                    "type",
                    "host",
                    "passphrase"
                ],
                "properties": {
                   "class": {
                       "title": "Class",
                       "description": "Telemetry services consumer class",
                       "type": "string",
                       "enum": [ "Telemetry_Consumer" ]
                   },
                   "enabled": {
                        "title": "Enabled",
                        "description": "" ,
                        "type": "boolean",
                        "default": true
                    },
                    "trace": {
                        "title": "Trace",
                        "description": "Enables data dumping to file. Value could be string - path to file to dump data to." ,
                        "type": ["boolean", "string"],
                        "default": false
                    },
                    "type": {
                        "title": "Type",
                        "description": "" ,
                        "type": "string",
                        "enum": [ "default", "Splunk", "Azure_Log_Analytics", "AWS_S3" ]
                    },
                    "host": {
                        "title": "Host",
                        "description": "" ,
                        "type": "string",
                        "format": "hostname"
                    },
                    "port": {
                        "$comment": "Certain consumers may not require this",
                        "title": "Port",
                        "description": "" ,
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 65535
                    },
                    "protocol": {
                        "title": "Protocol",
                        "description": "" ,
                        "type": "string",
                        "enum": [ "http", "https" ],
                        "default": "https"
                    },
                    "passphrase": { "$ref": "base_schema.json#/definitions/secret" },
                    "region": {
                        "$comment": "Required for certain consumers",
                        "title": "Region",
                        "description": "" ,
                        "type": "string"
                    }
                },
                "additionalProperties": true
            },
            "else": {}
        }
    ]
}