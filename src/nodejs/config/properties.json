{
    "stats": {
        "hostname": {
            "key": "/mgmt/tm/sys/global-settings::hostname",
            "normalize": null,
            "convertArrayToMap": null,
            "filterKeys": null,
            "renameKeys": null,
            "runFunction": null,
            "addKeysByTag": null
        },
        "version": {
            "key": "/mgmt/tm/sys/version::sys/version/0::Version"
        },
        "versionBuild": {
            "key": "/mgmt/tm/sys/version::sys/version/0::Build"
        },
        "location": {
            "key": "/mgmt/tm/cm/device::items::{{HOSTNAME}}::location",
            "convertArrayToMap": { "keyName": "name" }
        },
        "description": {
            "key": "/mgmt/tm/cm/device::items::{{HOSTNAME}}::description",
            "convertArrayToMap": { "keyName": "name" }
        },
        "marketingName": {
            "key": "/mgmt/tm/cm/device::items::{{HOSTNAME}}::marketingName",
            "convertArrayToMap": { "keyName": "name" }
        },
        "platformId": {
            "key": "/mgmt/tm/cm/device::items::{{HOSTNAME}}::platformId",
            "convertArrayToMap": { "keyName": "name" }
        },
        "chassisId": {
            "key": "/mgmt/tm/cm/device::items::{{HOSTNAME}}::chassisId",
            "convertArrayToMap": { "keyName": "name" }
        },
        "baseMac": {
            "key": "/mgmt/tm/sys/hardware::sys/hardware/platform::sys/hardware/platform/0::baseMac"
        },
        "callBackUrl": {
            "key": "/mgmt/tm/sys/management-ip::items",
            "convertArrayToMap": { "keyName": "name" },
            "runFunction": { "name": "getFirstKey", "args": { "splitOnValue": "/", "keyPrefix": "https://" } }
        },
        "configReady": {
            "if": {
                "deviceVersionGreaterOrEqual": "13.1"
            },
            "then": {
                "key": "/mgmt/tm/sys/ready::sys/ready/0::configReady"
            },
            "else": {
                "disabled": true
            }
        },
        "licenseReady": {
            "if": {
                "deviceVersionGreaterOrEqual": "13.1"
            },
            "then": {
                "key": "/mgmt/tm/sys/ready::sys/ready/0::licenseReady"
            },
            "else": {
                "disabled": true
            }
        },
        "provisionReady": {
            "if": {
                "deviceVersionGreaterOrEqual": "13.1"
            },
            "then": {
                "key": "/mgmt/tm/sys/ready::sys/ready/0::provisionReady"
            },
            "else": {
                "disabled": true
            }
        },
        "syncMode": {
            "key": "/mgmt/tm/cm/sync-status::cm/sync-status/0::mode"
        },
        "syncColor": {
            "key": "/mgmt/tm/cm/sync-status::cm/sync-status/0::color"
        },
        "syncStatus": {
            "key": "/mgmt/tm/cm/sync-status::cm/sync-status/0::status"
        },
        "syncSummary": {
            "key": "/mgmt/tm/cm/sync-status::cm/sync-status/0::summary"
        },
        "failoverStatus": {
            "key": "/mgmt/tm/cm/failover-status::cm/failover-status/0::status"
        },
        "failoverColor": {
            "key": "/mgmt/tm/cm/failover-status::cm/failover-status/0::color"
        },
        "deviceTimestamp": {
            "key": "/mgmt/tm/sys/clock::sys/clock/0::fullDate"
        },
        "cpu": {
            "key": "/mgmt/tm/sys/host-info::sys/host-info/0::sys/hostInfo/0/cpuInfo",
            "runFunction": { "name": "getAverage", "args": { "keyWithValue": "oneMinAvgSystem" } },
            "comment": "also oneMinAvgUser, need to determine how that should be factored in"
        },
        "memory": {
            "key": "/mgmt/tm/sys/memory::sys/memory/memory-host::sys/memory/memory-host/0",
            "runFunction": { "name": "getPercentFromKeys", "args": { "totalKey": "memoryTotal", "partialKey": "memoryUsed" } }
        },
        "tmmCpu": {
            "key": "/mgmt/tm/sys/tmm-info",
            "runFunction": { "name": "getAverage", "args": { "keyWithValue": "oneMinAvgUsageRatio" } }
        },
        "tmmMemory": {
            "key": "/mgmt/tm/sys/memory::sys/memory/memory-host::sys/memory/memory-host/0",
            "runFunction": { "name": "getPercentFromKeys", "args": { "totalKey": "tmmMemoryTotal", "partialKey": "tmmMemoryUsed" } }
        },
        "tmmTraffic": {
            "key": "/mgmt/tm/sys/tmm-traffic",
            "filterKeys": [ "/tmm-traffic", "clientSideTraffic.bitsIn", "clientSideTraffic.bitsOut" ],
            "renameKeys": { "patterns": { "sys/tmm-traffic": { "pattern": "([0-9]\\.[0-9])" } } },
            "runFunction": { "name": "getSum", "args": {} },
            "comment": "bits, but over what time period?"
        },
        "diskStorage": {
            "key": "diskStorageRef::commandResult",
            "runFunction": { "name": "formatAsJson", "args": { "type": "csv", "mapKey": "Mounted", "filterKeys": [ "/", "Capacity", "1024-blocks" ] } }
        },
        "diskLatency": {
            "key": "diskLatencyRef::commandResult",
            "runFunction": { "name": "formatAsJson", "args": { "type": "csv", "mapKey": "Device:", "filterKeys": [ "sd", "dm", "rsec/s", "wsec/s" ] } }
        },
        "networkInterfaces": {
            "key": "/mgmt/tm/net/interface/stats",
            "filterKeys": [ "/stats", "counters.bitsIn", "counters.bitsOut", "status" ],
            "renameKeys": { "patterns": { "net/interface": { "pattern": "([0-9]\\.[0-9]|(?!\/)mgmt(?=\/))" } } }
        },
        "provisionState": {
            "key": "/mgmt/tm/sys/provision::items",
            "convertArrayToMap": { "keyName": "name", "keyNamePrefix": "name/" },
            "filterKeys": [ "name/", "level" ],
            "renameKeys": { "patterns": { "name/": { "pattern": "name\/(.*)", "group": 1 } } }
        },
        "virtualServerStats": {
            "key": "/mgmt/tm/ltm/virtual::items",
            "convertArrayToMap": { "keyName": "fullPath", "keyNamePrefix": "name/" },
            "filterKeys": [ "name/", "/stats", "clientside.bitsIn", "clientside.bitsOut", "clientside.curConns", "availabilityState", "enabledState", "destination" ],
            "renameKeys": { "patterns": { "name/": { "pattern": "name\/(.*)", "group": 1 }, "ltm/virtual": { "pattern": "virtual\/(.*)\/", "group": 1 } } },
            "includeFirstEntry": { "pattern": "/stats" },
            "addKeysByTag": true
        },
        "poolStats": {
            "key": "/mgmt/tm/ltm/pool::items",
            "convertArrayToMap": { "keyName": "selfLink", "keyNamePrefix": "name/" },
            "filterKeys": [ "name/", "/stats", "membersReference", "addr", "port", "serverside.bitsIn", "serverside.bitsOut", "serverside.curConns", "availabilityState", "statusReason", "enabledState", "sessionStatus" ],
            "renameKeys": { "patterns": { "name/": { "pattern": "name\/(.*)", "group": 1 }, "ltm/pool/": { "pattern": "pool\/(.*)\\?", "group": 1 } , "members/": { "pattern": "members\/(.*)\/", "group": 1 }, "membersReference": "members" } },
            "includeFirstEntry": { "pattern": "/stats", "excludePattern": "/members/" },
            "addKeysByTag": true
        },
        "ltmPolicyStats": {
            "key": "/mgmt/tm/ltm/policy/stats",
            "filterKeys": [ "ltm/policy", "invoked", "succeeded" ],
            "renameKeys": { "patterns": [ { "ltm/policy/": { "pattern": "policy\/(.*)\/", "group": 1 }, "/actions/": { "pattern": "actions\/(.*)", "group": 1 } }, { "/actions": { "constant": "actions" } } ] },
            "addKeysByTag": true
        },
        "httpProfileStats": {
            "key": "httpProfile",
            "filterKeys": [ "ltm/profile/", "getReqs", "postReqs", "numberReqs", "maxKeepaliveReq", "v9Reqs", "v10Reqs", "v11Reqs", "v9Resp", "v10Resp", "v11Resp", "resp_2xxCnt", "resp_3xxCnt", "resp_4xxCnt", "resp_5xxCnt", "respBucket_2m", "respBucketLarge", "cookiePersistInserts", "proxyReqs" ],
            "renameKeys": { "patterns": { "ltm/profile/http/": { "pattern": "http\/(.*)\/", "group": 1 } } },
            "addKeysByTag": true
        },
        "clientSSLProfileStats": {
            "key": "clientSSLProfile",
            "filterKeys": [ "ltm/profile/", "common.encryptedBytesIn", "common.encryptedBytesOut", "common.decryptedBytesIn", "common.decryptedBytesOut", "common.recordsIn", "common.recordsOut", "common.curConns", "common.curNativeConns", "common.curCompatConns", "common.currentActiveHandshakes", "common.fatalAlerts", "common.handshakeFailures", "common.protocolUses.dtlsv1", "common.protocolUses.sslv2", "common.protocolUses.sslv3", "common.protocolUses.tlsv1", "common.protocolUses.tlsv1_1", "common.protocolUses.tlsv1_2", "common.protocolUses.tlsv1_3", "common.peercertValid", "common.peercertInvalid", "common.peercertNone" ],
            "renameKeys": { "patterns": { "ltm/profile/client-ssl/": { "pattern": "client-ssl\/(.*)\/", "group": 1 }, "common.": { "pattern": "common.(.*)", "group": 1 } } },
            "addKeysByTag": true
        },
        "serverSSLProfileStats": {
            "key": "serverSSLProfile",
            "filterKeys": [ "ltm/profile/", "common.encryptedBytesIn", "common.encryptedBytesOut", "common.decryptedBytesIn", "common.decryptedBytesOut", "common.recordsIn", "common.recordsOut", "common.curConns", "common.curNativeConns", "common.curCompatConns",  "common.curConns", "common.curNativeConns", "common.curCompatConns", "common.currentActiveHandshakes", "common.fatalAlerts", "common.handshakeFailures", "common.protocolUses.dtlsv1", "common.protocolUses.sslv2", "common.protocolUses.sslv3", "common.protocolUses.tlsv1", "common.protocolUses.tlsv1_1", "common.protocolUses.tlsv1_2", "common.protocolUses.tlsv1_3", "common.peercertValid", "common.peercertInvalid", "common.peercertNone" ],
            "renameKeys": { "patterns": { "ltm/profile/server-ssl/": { "pattern": "server-ssl\/(.*)\/", "group": 1 }, "common.": { "pattern": "common.(.*)", "group": 1 } } },
            "addKeysByTag": true
        },
        "tlsCerts": {
            "key": "/mgmt/tm/sys/file/ssl-cert::items",
            "convertArrayToMap": { "keyName": "name", "keyNamePrefix": "name/" },
            "filterKeys": [ "name/", "expirationDate", "expirationString", "subject", "issuer", "email" ],
            "renameKeys": { "patterns": { "name/": { "pattern": "name\/(.*)", "group": 1 } } }
        }
    },
    "events": {
        "classifyByKeys": [ "virtual_name", "policy_name", "Access_Profile", "context_name" ]
    },
    "context": {
        "HOSTNAME": {
            "key": "/mgmt/tm/sys/global-settings::hostname"
        },
        "deviceVersion": {
            "key": "/mgmt/tm/sys/version::sys/version/0::Version"
        }
    },
    "global": {
        "addKeysByTag": { "skip": [ "actions", "members" ] },
        "renameKeys": {
            "patterns": {
                "~": { "replaceCharacter": "/", "exactMatch": false },
                "ASM:unit_hostname": { "constant": "hostname", "exactMatch": false },
                "BIGIP_HOSTNAME": { "constant": "hostname" },
                "status.availabilityState": { "constant": "availabilityState" },
                "status.enabledState": { "constant": "enabledState" },
                "resp_2xxCnt": { "constant": "2xxResp" },
                "resp_3xxCnt": { "constant": "3xxResp" },
                "resp_4xxCnt": { "constant": "4xxResp" },
                "resp_5xxCnt": { "constant": "5xxResp" },
                "respBucket_2m": { "constant": "respLessThan2m" },
                "respBucketLarge": { "constant": "respGreaterThan2m" },
                "curConns": { "constant": "currentConnections" },
                "curNativeConns": { "constant": "currentNativeConnections" },
                "curCompatConns": { "constant": "currentCompatibleConnections" }
            },
            "options": {
                "exactMatch": true
            }
        }
    },
    "definitions": {
        "`T`": { "pattern": "\/(.*?)\/", "group": 1 },
        "`A`": { "pattern": "\/(.*?)\/(.*?)\/", "group": 2 }
    }
}